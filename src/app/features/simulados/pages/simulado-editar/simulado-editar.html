<div class="container" style="max-width: 800px;">
  
  <div class="mt-4">
    <a routerLink="/simulados" class="btn btn-outline-secondary d-inline-flex align-items-center gap-2 rounded-3 px-3" style="cursor: pointer;">
      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-left" viewBox="0 0 16 16">
        <path fill-rule="evenodd" d="M15 8a.5.5 0 0 0-.5-.5H2.707l3.147-3.146a.5.5 0 1 0-.708-.708l-4 4a.5.5 0 0 0 0 .708l4 4a.5.5 0 0 0 .708-.708L2.707 8.5H14.5A.5.5 0 0 0 15 8z"/>
      </svg>
      Cancelar e Voltar
    </a>
  </div>

  <div class="container py-5 border rounded-3 mb-5 p-5 bg-white shadow-sm" style="margin-top: 20px; max-width: 800px;">

    <h2 class="fw-bold mb-4">Editar Simulado</h2>

    <div class="card shadow-sm border-0 mb-5">
      <div class="card-body p-4">
        
        <div class="mb-3">
          <label class="form-label fw-bold">Nome do Simulado</label>
          <input type="text" class="form-control" [(ngModel)]="form.nome" placeholder="Ex: Simulado de Java">
        </div>

        <div class="mb-3">
          <label class="form-label fw-bold">Descrição</label>
          <textarea class="form-control" [(ngModel)]="form.descricao" rows="2"></textarea>
        </div>

      </div>
    </div>

    <h4 class="fw-bold mb-3 d-flex justify-content-between align-items-center">
      Gerenciar Questões
      <span class="badge bg-secondary rounded-pill fs-6">{{ questoesDetalhadas.length }}</span>
    </h4>

    <div *ngIf="isLoading" class="text-center py-4">
      <div class="spinner-border text-primary" role="status"></div>
    </div>

    <div *ngIf="!isLoading && questoesDetalhadas.length === 0" class="alert alert-warning">
      Este simulado não tem questões. Adicione novas pelo portal de questões.
    </div>

    <div *ngFor="let questao of questoesDetalhadas; let i = index" class="card mb-3 border-0 shadow-sm">
      
      <div class="card-body d-flex flex-column flex-md-row justify-content-between align-items-start gap-3">
        
        <div class="flex-grow-1 w-100">
          
          <div class="text-muted small mb-1 font-monospace">
            {{ questao.id }}
          </div>
          
          <div class="d-flex flex-wrap gap-2 mb-2">
            <span class="badge bg-light text-dark text-wrap text-start border">{{ questao.disciplina }}</span>
            <span class="badge bg-light text-dark border">{{ questao.dificuldade }}</span>
          </div>
          
          <markdown 
            [data]="(questao.enunciado | slice:0:500) + '...' | removeImageMarkdown:true | katex" 
            class="enunciado-markdown markdown-content text-muted small">
          </markdown>
        </div>

        <button class="btn btn-outline-danger btn-sm d-flex align-items-center justify-content-center gap-2 mt-2 mt-md-0 w-100 w-md-auto" 
                (click)="removerQuestao(i)"
                title="Remover do simulado">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-trash" viewBox="0 0 16 16">
            <path d="M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5Zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5Zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6Z"/>
            <path d="M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1ZM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118ZM2.5 3h11V2h-11v1Z"/>
          </svg>
          Remover
        </button>

      </div>
    </div>

    <div class="d-grid gap-2 mt-5 mb-5">
      <button class="btn btn-primary btn-lg rounded-pill fw-bold" (click)="salvarAlteracoes()">
        Salvar Alterações
      </button>
    </div>

  </div>
</div>